<?php

/**
 * Implements hook_cron().
 */
function trending_images_cron() {
  \Drupal::service('trending_images.service')->processTrendingFields();
}

/**
 * Implements hook_theme().
 */
function trending_images_theme($existing, $type, $theme, $path) {
  return [
    'trending_images_formatter' => [
      'variables' => [
          'image_uri' => '',
          'likes' => '',
          'comments' => '',
          'source' => '',
          'width' => '',
          'height' => '',
          'url' => '',
          'description' => '',
      ],
      'template' => 'trending-images-formatter',
    ],
  ];
}

function trending_images_validate_resolution(\Drupal\file\FileInterface $file, $max_width = 0, $max_height = 0) {
  $size = getimagesize($file->getFileUri());
  $errors = [];
  if (!empty($size) && $size[0] > $max_width || $size[0] > $max_height ) {
    $errors[] = t('The file is exceeding the maximum file size of %maxwidthpx x %maxheightpx.', ['%maxwidth' => $max_width, '%maxheight' => $max_height]);
  }
  return $errors;
}
