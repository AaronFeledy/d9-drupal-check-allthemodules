<?php

/**
 * @file
 * Test specific changes for the jQCloud library test.
 */

use Drupal\Core\Site\Settings;
use Drupal\Core\Routing\RouteMatchInterface;

/**
 * Implements hook_help().
 */
function jqcloud_library_test_help($route_name, RouteMatchInterface $route_match) {

  switch ($route_name) {
    case 'help.page.jqcloud_library_test':
      $output = '<p> ' . t('jqCloud test module') . '</p>';

      return $output;
  }
}

/**
 * Implements hook_library_info_alter().
 */
function jqcloud_library_test_library_info_alter(&$libraries, $extension) {
  if ($extension !== 'jqcloud') {
    return;
  }

  $file_public_path = Settings::get('file_public_path');
  if (!empty($file_public_path)) {
    $file_public_path = '/' . $file_public_path;

    foreach ($libraries['jqcloud']['js'] as $key => $library) {
      $libraries['jqcloud']['js'][$file_public_path . $key] = $library;
      unset($libraries['jqcloud']['js'][$key]);
    }

    foreach ($libraries['jqcloud-styles']['css']['theme'] as $key => $library) {
      $libraries['jqcloud-styles']['css']['theme'][$file_public_path . $key] =
        $library;
      unset($libraries['jqcloud-styles']['css']['theme'][$key]);
    }
  }
}
