pki_ra.settings_form:
  path: '/admin/config/services/pki-ra'
  defaults:
    _title: 'PKI Registration Authority'
    _form: \Drupal\pki_ra\Form\PKIRASettingsForm
  requirements:
    _permission: 'administer pki registration'

pki_ra.settings_form.messages:
  path: '/admin/config/services/pki-ra/messages'
  defaults:
    _title: 'Messages'
    _form: \Drupal\pki_ra\Form\PKIRAMessageSettingsForm
  requirements:
    _permission: 'administer pki registration'

pki_ra.registration.start:
  path: '/registration/start'
  defaults:
    _title: 'PKI Registration'
    _controller: '\Drupal\pki_ra\Controller\PKIRAController::beginRegistrationProcess'
  requirements:
    _access: 'TRUE'

# @see user.reset
registration.verify:
  path: '/registration/verify/{registration_id}/{timestamp}/{hash}'
  defaults:
    _controller: '\Drupal\pki_ra\Controller\PKIRAController::redirectToEmailVerificationForm'
    _title: 'Verify e-mail address'
  requirements:
    _access: 'TRUE'
  options:
    no_cache: TRUE

# @see user.reset.form
registration.verify.form:
  path: '/registration/verify/{registration_id}'
  defaults:
    _controller: '\Drupal\pki_ra\Controller\PKIRAController::getEmailVerificationForm'
    _title: 'Verify e-mail address'
  requirements:
    _user_is_logged_in: 'FALSE'
  options:
    no_cache: TRUE

# @see user.reset.login
registration.verify.confirm:
  path: '/registration/verify/{registration_id}/{timestamp}/{hash}/confirm'
  defaults:
    _controller: '\Drupal\pki_ra\Controller\PKIRAController::confirmRegistration'
    _title: 'Validate e-mail address and confirm registration'
  requirements:
    _user_is_logged_in: 'FALSE'
  options:
    no_cache: TRUE

registration.display.certificate.generation.form:
  path: '/certificate/generate/{registration_id}'
  defaults:
    _controller: '\Drupal\pki_ra\Controller\PKIRAController::displayCertificateGenerationForm'
    _title: 'Generate certificate'
  requirements:
    _user_is_logged_in: 'FALSE'
  options:
    no_cache: TRUE

pki_ra.registration.resend.verification:
  path: '/registration/send-verification-email'
  defaults:
    _title: 'Send Verification Email'
    _form: \Drupal\pki_ra\Form\ResendVerificationEmailForm
  requirements:
    _access: 'TRUE'

pki_ra.settings_form.eoi_sources:
  path: '/admin/config/services/pki-ra/eoi-sources'
  defaults:
    _title: 'Configure EOI Sources'
    _form: \Drupal\pki_ra\Form\EoiSourcesConfigurationForm
  requirements:
    _permission: 'administer pki registration'

pki_ra.progress.indicator:
  path: '/user/{user}/progress'
  defaults:
    _controller: '\Drupal\pki_ra\Controller\PKIRAController::displayUserEoiSourcesProgress'
    _title: 'Enrollment Progress'
  requirements:
    _user_is_logged_in: 'TRUE'
