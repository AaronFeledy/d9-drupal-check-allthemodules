<?php

/**
 * @file
 * For implementation Field Formatter key.
 */

use Drupal\Core\Form\FormStateInterface;
use Drupal\Core\Field\FieldDefinitionInterface;
use Drupal\Core\Field\FormatterInterface;
use Drupal\Component\Utility\Xss;
use Drupal\Core\Routing\RouteMatchInterface;

/**
 * Implements hook_help().
 */
function field_formatter_key_label_help($route_name, RouteMatchInterface $route_match) {
  return $route_name == 'help.page.field_formatter_key_label' ?
    check_markup(file_get_content_headers(dirname(__FILE__) . "/README.md")) : NULL;
}

/**
 * Implements hook_field_formatter_settings_summary_alter().
 */
function field_formatter_key_label_field_formatter_settings_summary_alter(&$summary, $context) {
  $setting = $context['formatter']->getThirdPartySetting('field_formatter_key_label', 'defaultKey');
  if (!empty($setting)) {
    $summary[] = t('defaultKey: @defaultKey', ['@defaultKey' => Xss::filter($setting, [])]);
  }
}

/**
 * Implements hook_field_formatter_third_party_settings_form().
 */
function field_formatter_key_label_field_formatter_third_party_settings_form(FormatterInterface $plugin, FieldDefinitionInterface $field_definition, $view_mode, $form, FormStateInterface $form_state) {
  $element['defaultKey'] = [
    '#type' => 'textfield',
    '#title' => t('Field Formatter Key'),
    '#default_value' => $plugin->getThirdPartySetting('field_formatter_key_label', 'defaultKey'),
  ];
  return $element;
}
