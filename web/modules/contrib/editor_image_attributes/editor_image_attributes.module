<?php

/**
 * @file
 * Defines custom css to add on editor.
 */

use Drupal\Core\Form\FormStateInterface;

/**
 * Implements hook_form_FORM_ID_alter().
 */
function editor_image_attributes_form_editor_image_dialog_alter(&$form, FormStateInterface $form_state, $form_id) {
  if (isset($form_state->getUserInput()['editor_object'])) {
    $input = $form_state->getUserInput()['editor_object'];
    $form_state->set('editor_image', $input);
    $form_state->setCached(TRUE);
  }
  else {
    // Retrieve the link element's attributes from form state.
    $input = $form_state->get('editor_image') ?: [];
  }
  $form['attributes']['editor_id'] = [
    '#type' => 'textfield',
    '#title' => t('ID'),
    '#default_value' => !empty($input['editor_id']) ? $input['editor_id'] : '',
  ];
  $form['attributes']['editor_class'] = [
    '#type' => 'textfield',
    '#title' => t('Class'),
    '#default_value' => !empty($input['editor_class']) ? $input['editor_class'] : '',
  ];
  $form['attributes']['editor_extra'] = [
    '#type' => 'textfield',
    '#title' => t('Extra Attribute'),
    '#default_value' => !empty($input['editor_extra']) ? $input['editor_extra'] : '',
  ];
  array_unshift($form['#submit'], '_editor_image_attributes_submit');
}

/**
 * {@inheritdoc}
 */
function _editor_image_attributes_submit(array &$form, FormStateInterface $form_state) {
  $input = $form_state->getValue('attributes');
  $form_state->setValue(['attributes', 'editor_id'], $input['editor_id']);
  $form_state->setValue(['attributes', 'editor_class'], $input['editor_class']);
  $form_state->setValue(['attributes', 'editor_extra'], $input['editor_extra']);
}
