<?php

/**
 * @file
 * Contains ext_redirect_sort.module.
 */

use Drupal\Component\Utility\Html;
use Drupal\Core\Routing\RouteMatchInterface;

/**
 * Implements hook_help().
 */
function ext_redirect_sort_help($route_name, RouteMatchInterface $route_match) {
  switch ($route_name) {
    // Main module help for the ext_redirect_sort module.
    case 'help.page.ext_redirect_sort':
      $output = '';
      $output .= '<h3>' . t('About') . '</h3>';
      $output .= '<p>' . t('Integrate Redirect Rules list view with jQuery TableSort') . '</p>';
      return $output;

    default:
  }
}

/**
 * Implements hook_preprocess_views_view_table().
 */
function ext_redirect_sort_preprocess_views_view_table(&$variables) {
  $view = $variables['view'];
  if (!isset($view->field['weight_views_field'])) {
    return;
  }


  // Add table attributes.
  $variables['attributes']['id'] = ext_redirect_sort_table_id($view);

  // Add rows attributes.
  foreach ($variables['rows'] as &$row) {
    $row['attributes']->addClass('draggable');
  }
}

function ext_redirect_sort_table_id($view) {
  return Html::getId($view->id() . '-' . $view->current_display);
}

