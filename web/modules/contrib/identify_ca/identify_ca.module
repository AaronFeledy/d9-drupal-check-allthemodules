<?php

/**
 * Implement hook_boot
 * @todo: move this to a class as described in https://www.drupal.org/node/1909596
 * 
 * Check if openssl.cafile is set in your php.ini file.
 * Check if curl.cainfo is set in your php.ini file.
 * Check if /etc/pki/tls/certs/ca-bundle.crt exists (Red Hat, CentOS, Fedora; provided by the ca-certificates package)
 * Check if /etc/ssl/certs/ca-certificates.crt exists (Ubuntu, Debian; provided by the ca-certificates package)
 * Check if /usr/local/share/certs/ca-root-nss.crt exists (FreeBSD; provided by the ca_root_nss package)
 * Check if /usr/local/etc/openssl/cert.pem (OS X; provided by homebrew)
 * Check if C:\windows\system32\curl-ca-bundle.crt exists (Windows)
 * Check if C:\windows\curl-ca-bundle.crt exists (Windows)
 * 
 * @todo include https://curl.haxx.se/ca/cacert.pem and provide a mechanism to update it automatically/regularly
 * 
 * @return type
 */
function identify_ca_boot() {
  $files = array(
    ini_get('openssl.cafile'),
    '/etc/pki/tls/certs/ca-bundle.crt',
    '/etc/ssl/certs/ca-certificates.crt',
    '/usr/local/share/certs/ca-root-nss.crt',
    '/usr/local/etc/openssl/cert.pem',
    'C:\windows\system32\curl-ca-bundle.crt',
    'C:\windows\curl-ca-bundle.crt',
  );
  foreach($files as $filename) {
    if ($filename != '' && file_exists($filename) && is_readable($filename)) {
      ini_set('openssl.cafile', $filename);
    }
  }
}
