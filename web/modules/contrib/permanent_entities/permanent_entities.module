<?php

/**
 * @file
 * Contains permanent_entities.module.
 */

use Drupal\Core\Routing\RouteMatchInterface;

/**
 * Implements hook_help().
 */
function permanent_entities_help($route_name, RouteMatchInterface $route_match) {
  switch ($route_name) {

    case 'help.page.permanent_entities':
      $output = '';
      $output .= '<h3>' . t('About') . '</h3>';
      $output .= '<p>' . t('Permanent entity provides a new type of entity that can be only created and deleted from code but not from the UI.') . '</p>';
      $output .= '<p>' . t('Since permanent entities can only be edited, you can use them to provide permanent values that can be rendered or referenced without risk of deletion by error.') . '</p>';
      $output .= '<p>' . t('The main use case for this module is to create enties that can be have fields but rarelly can change during time. An example of this could be, the planets of the solar system.') . '</p>';
      return $output;

    default:
  }
}

/**
 * Implements hook_theme().
 */
function permanent_entities_theme() {
  $theme = [];
  $theme['permanent_entity'] = [
    'render element' => 'elements',
    'file' => 'permanent_entities.page.inc',
    'template' => 'permanent_entity',
  ];
  $theme['permanent_entity_content_add_list'] = [
    'render element' => 'content',
    'variables' => ['content' => NULL],
    'file' => 'permanent_entities.page.inc',
  ];
  return $theme;
}

/**
 * Implements hook_theme_suggestions_HOOK().
 */
function permanent_entities_theme_suggestions_permanent_entity(array $variables) {
  $suggestions = [];
  $entity = $variables['elements']['#permanent_entity'];
  $sanitized_view_mode = strtr($variables['elements']['#view_mode'], '.', '_');

  $suggestions[] = 'permanent_entity__' . $sanitized_view_mode;
  $suggestions[] = 'permanent_entity__' . $entity->bundle();
  $suggestions[] = 'permanent_entity__' . $entity->bundle() . '__' . $sanitized_view_mode;
  $suggestions[] = 'permanent_entity__' . $entity->id();
  $suggestions[] = 'permanent_entity__' . $entity->id() . '__' . $sanitized_view_mode;
  return $suggestions;
}
