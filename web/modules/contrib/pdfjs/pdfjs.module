<?php
/**
 * @file: Contains some hook define a view for pdf
 */

/**
 * Implements hook_theme().
 */
function pdfjs_theme() {
  return array(
    'file_pdfjs' => array(
      'variables' => array('file' => NULL, 'description' => NULL, 'attributes' => NULL),
      'template' => 'file-pdfjs',
    ),
  );
}


/**
 * Prepares variables for file link templates.
 *
 * Default template: file-link.html.twig.
 *
 * @param array $variables
 *   An associative array containing:
 *   - file: A file object to which the link will be created.
 *   - icon_directory: (optional) A path to a directory of icons to be used for
 *     files. Defaults to the value of the "icon.directory" variable.
 *   - description: A description to be displayed instead of the filename.
 *   - attributes: An associative array of attributes to be placed in the a tag.
 */
function template_preprocess_file_pdfjs(&$variables) {
  $file = $variables['file'];
  $file_entity = ($file instanceof \Drupal\file\Entity\File) ? $file : \Drupal\file\Entity\File::load($file->fid);
  // Use the description as the link text if available.
  if (empty($variables['description'])) {
    $link_text = $file_entity->getFilename();
  }
  else {
    $link_text = $variables['description'];
  }
  $options = array(
    'data-uri' => file_create_url($file_entity->getFileUri()),
    'data-filename' => $link_text,
    'class' => array('pdfjs-canvas'),
  );
  $variables['attributes'] = $options;
}