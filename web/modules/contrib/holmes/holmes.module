<?php

function holmes_preprocess_html(&$variables) {
  // Get the current request.
  $request = \Drupal::request();

  // Get the current user.
  $user = \Drupal::currentUser();

  if ($user->hasPermission('use holmes')) {
    $enable_holmes = $request->query->get('holmes-debug');
    $variables['#attached']['library'][] = 'holmes/holmes';

    if ($enable_holmes && $enable_holmes == 'true') {
      $variables['attributes']['class'][] = 'holmes-debug';
      $variables['#attached']['drupalSettings']['holmesEnabled'] = true;
    }
  }
}
