<?php
/**
 * @file
 * Base module file.
 */

/**
 * Implements template_preprocess_page.
 */
function bg_rotate_preprocess_page(&$vars) {
  $bg_rotate = \Drupal::service('bg_rotate');
  // Abort if admin page and setting says nope.
  $is_admin = \Drupal::service('router.admin_context')->isAdminRoute();
  if ($is_admin && !$bg_rotate->showAdmin()) {
    return;
  }
  // Get settings.
  $settings = $bg_rotate->getSettings();
  if (!empty($settings)) {
    // Send to js settings.
    $vars['#attached']['drupalSettings']['bg_rotate'] = $settings;
    // Add library.
    $vars['#attached']['library'][] = 'bg_rotate/main';
  }

}
