services:
  cache.client_connection:
    class: 'Drupal\Core\Cache\CacheBackendInterface'
    tags:
      - { name: cache.bin }
    factory: cache_factory:get
    arguments: [client_connection]
  client_connection.default_connection_resolver:
    class: Drupal\client_connection\Resolver\DefaultConnectionResolver
    arguments: ['@entity_type.manager']
    tags:
      - { name: client_connection.resolver, priority: -100 }
  plugin.manager.client_connection:
    class: Drupal\client_connection\ClientConnectionManager
    arguments: ['@cache.client_connection', '@class_resolver', '@entity_type.manager']
    parent: default_plugin_manager
    tags:
          - { name: service_id_collector, tag: client_connection.resolver }
