services:
  commerce_product_reservation.cart_provider:
    class: Drupal\commerce_product_reservation\CartProvider
    decorates: commerce_cart.cart_provider
    arguments: ['@entity_type.manager', '@commerce_store.current_store', '@current_user', '@commerce_cart.cart_session']
    public: false

  commerce_product_reservation.cart_form_handler:
    class: Drupal\commerce_product_reservation\CartFormHandler
    arguments:
      - "@entity_type.manager"
      - "@logger.factory"
      - "@messenger"
      - "@commerce_product_reservation.selected_store"
      - "@plugin.manager.reservation_store"
      - "@request_stack"
      - "@form_builder"
      - "@module_handler"
      - "@commerce_product_reservation.cart_adder"

  commerce_product_reservation.selected_store:
    class: Drupal\commerce_product_reservation\SelectedStoreManager
    arguments:
      - "@tempstore.private"

  plugin.manager.reservation_store:
    class: Drupal\commerce_product_reservation\ReservationStorePluginManager
    parent: default_plugin_manager

  commerce_product_reservation.cart_adder:
    class: Drupal\commerce_product_reservation\CartAdder
    arguments:
      - "@entity_type.manager"
      - "@commerce_cart.cart_manager"
      - "@commerce.availability_manager"
      - "@commerce_store.current_store"
      - "@commerce_cart.cart_provider"
      - "@current_user"
      - "@commerce_product_reservation.selected_store"
      - "@plugin.manager.reservation_store"
