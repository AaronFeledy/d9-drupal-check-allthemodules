<?php

/**
 * Function to get the split statistics
 */
function getRecieveStat() {
	$user = \Drupal::currentUser();
	$query = db_query('SELECT id, amount, sender_uid FROM split_data where splitter_uid = '.$user->id().' and sender_uid != '.$user->id())->fetchAll();
	$stat_string = array();
	foreach ($query as $key => $value) {
		if($value->amount != 0) {
			$row = array();
			$account = \Drupal\user\Entity\User::load($value->sender_uid); 
     		$sender = $account->getUsername();
			$row[] = 'You have to recieved Rs. '.$value->amount.' from '.$sender;
			$stat_string[$value->sender_uid] = $row;
		}
	}
	return $stat_string;
}

function getSendStat() {
	$user = \Drupal::currentUser();
	$stat_string = array();
	$query = db_query('SELECT id, splitter_uid, amount FROM `split_data` where sender_uid = '.$user->id().' and splitter_uid != '.$user->id())->fetchAll();	
	foreach ($query as $key => $value) {
		if($value->amount != 0) {
			$row = array();
			$account = \Drupal\user\Entity\User::load($value->splitter_uid); 
     		$splitter = $account->getUsername();
			$row[] = 'You have to send Rs. '.$value->amount.' to '.$splitter;
			$stat_string[$value->splitter_uid] = $row;
		}
		
	}
	return $stat_string;
}