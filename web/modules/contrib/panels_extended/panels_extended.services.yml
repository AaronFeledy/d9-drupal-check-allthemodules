services:
  panels_extended.variant_route_filter:
    class: Drupal\panels_extended\Routing\JsonVariantRouteFilter
    arguments: ['@entity_type.manager', '@path.current', '@request_stack']
    tags:
      - { name: route_filter, priority: -2000 }
      - { name: service_collector, tag: route_enhancer, call: addRouteEnhancer }

  panels_extended.layout_manager.decorator:
    class: Drupal\panels_extended\ConfigurableLayoutPluginManager
    decorates: plugin.manager.core.layout
    parent: plugin.manager.core.layout
    arguments: ['@config.factory']

  panels_extended.plugin.manager.display_builder:
    class: Drupal\panels_extended\ConfigurableDisplayBuilderManager
    parent: plugin.manager.panels.display_builder
    arguments: ['@config.factory']

  panels_extended.plugin.manager.block:
    class: Drupal\panels_extended\ConfigurableBlockManager
    parent: plugin.manager.block
    arguments: ['@config.factory']

  # Event Subscribers
  panels_extended.route_subscriber:
    class: Drupal\panels_extended\Routing\PanelsFormRouteSubscriber
    tags:
    - { name: event_subscriber }

  panels_extended.extended_content_form_subscriber:
    class: Drupal\panels_extended\EventSubscriber\ExtendedPanelsContentFormEventSubscriber
    arguments: ['@request_stack']
    tags:
      - { name: event_subscriber }

  panels_extended.json_variant_subscriber:
    class: Drupal\panels_extended\EventSubscriber\JsonVariantEventSubscriber
    tags:
      - { name: event_subscriber }
