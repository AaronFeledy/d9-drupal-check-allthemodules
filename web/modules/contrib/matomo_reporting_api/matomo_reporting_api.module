<?php

use GuzzleHttp\Exception\ConnectException;

/**
 * @file
 * Main functions and hook implementations of the Matomo Reporting API module.
 */

/**
 * Returns the API version of the Matomo server.
 *
 * @return bool|string
 *   The API version, or FALSE if an error occurred while connecting to the
 *   Matomo server.
 */
function matomo_reporting_api_get_api_version() {
  /** @var \Matomo\ReportingApi\QueryResult $result */
  $query = \Drupal::service('matomo.query_factory')->getQuery('API.getMatomoVersion');
  try {
    $result = $query->execute();
    if (!$result->hasError() && $result->parameterExists('value')) {
      return $result->get('value');
    }
  }
  catch (ConnectException $e) {
  }

  return FALSE;
}
