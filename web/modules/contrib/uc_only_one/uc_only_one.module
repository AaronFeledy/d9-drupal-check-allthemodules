<?php

use Drupal\Core\Url;
use \Drupal\node\Entity\Node;

/**
 * @file
 * Module file for uc_only_one_module.
 */

/**
 * @} End of "defgroup uc_only_one".
 */



function uc_only_one_form_uc_cart_view_form_alter(&$form, \Drupal\Core\Form\FormStateInterface $form_state, $form_id) {

	foreach($form['items'] as $key=>&$item){
	
		if(!is_numeric($key)){
			continue;  // this is not a numbered item and therefore not a product
		}
		$nid = $item['desc']['title']['#url']->getRouteParameters()['node'];
		$node = node_load($nid); 
		if($node->default_qty->value == 0){// only one allowed
			$item['qty']['#attributes'] = array('disabled' => 'disabled'); // no changes from this form.
		}
	}

}