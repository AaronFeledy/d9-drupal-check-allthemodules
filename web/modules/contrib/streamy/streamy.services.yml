services:
  streamy.event_subscriber_kernelonrequest:
    class: Drupal\streamy\EventSubscriber\KernelSubscriber
    arguments: ['@streamy.factory','@stream_wrapper_manager']
    tags:
      - { name: event_subscriber }

  streamy.streamy.stream_wrapper:
    class: \Drupal\streamy\StreamWrapper\DrupalFlySystemStreamWrapper
    tags:
     - { name: stream_wrapper, scheme: streamy }

  streamy.streamypvt.stream_wrapper:
    class: \Drupal\streamy\StreamWrapper\DrupalFlySystemStreamWrapper
    tags:
      - { name: stream_wrapper, scheme: streamypvt }

  plugin.manager.streamy.streamystreammanager:
    class: Drupal\streamy\StreamyStreamManager
    arguments: ['@config.factory', '@request_stack', '@logger.channel.streamy']
    parent: default_plugin_manager

  plugin.manager.streamy.streamycdnmanager:
    class: Drupal\streamy\StreamyCDNManager
    arguments: ['@config.factory', '@request_stack', '@logger.channel.streamy']
    parent: default_plugin_manager

  logger.channel.streamy:
    parent: logger.channel_base
    arguments: ['streamy']

  streamy.factory:
    class: Drupal\streamy\StreamyFactory
    arguments: ['@file_system', '@plugin.manager.streamy.streamystreammanager', '@plugin.manager.streamy.streamycdnmanager', '@config.factory', '@logger.channel.streamy', '@http_client', '@queue']

  path_processor.streamy:
    class: Drupal\streamy\PathProcessor\StreamyPathProcessor
    tags:
      - { name: path_processor_inbound, priority: 500 }