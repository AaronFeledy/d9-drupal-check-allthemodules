<?php
use Drupal\ot\Controller\OverrideMain;

function check(){
  $ot_main = new OverrideMain();
  $language = \Drupal::languageManager()->getCurrentLanguage()->getId();
  $language_arr = array('all', $language);
  $current_path = \Drupal::service('path.current')->getPath();
  $url_object = \Drupal::service('path.validator')->getUrlIfValid($current_path);
  if($url_object != false){
    $url_object->setAbsolute();
    $url = $url_object->toString();
  }
  return $ot_main->ReturnOtTitle($language_arr, @$url);

}

function ot_preprocess_html(&$variables){
  if(!empty(check()['title']) && in_array(check()['location'], ['both', 'source'])){
    $variables['head_title']['title'] = t(check()['title']);
  }
}

function ot_preprocess_page_title(&$variables) {
  if(!empty(check()['title']) && in_array(check()['location'], ['both', 'ui'])){
    $variables['title'] = t(check()['title']);
  }
}

function ot_cron(){
  $ot_main = new OverrideMain();
  $ot_main->cronCheckUrl();
}
