<?php

/**
 * @file
 * This is the primary module file.
 */

/**
 * Implements hook_raven_options_alter().
 */
function raven_release_raven_options_alter(array &$options) {
  $options['release'] = \Drupal::config('raven_release.settings')->get('version');
}

/**
 * Implements hook_page_attachments().
 */
function raven_release_page_attachments(array &$page) {
  if (\Drupal::config('raven.settings')->get('javascript_error_handler') && \Drupal::currentUser()->hasPermission('send javascript errors to sentry')) {
    if (!isset($page['#attached']['drupalSettings']['raven']['options'])) {
      $page['#attached']['drupalSettings']['raven']['options'] = new \stdClass();
    }
    $page['#attached']['drupalSettings']['raven']['options']->release = \Drupal::config('raven_release.settings')->get('version');
  }
}
