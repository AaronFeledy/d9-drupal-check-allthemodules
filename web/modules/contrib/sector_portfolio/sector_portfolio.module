<?php

/**
 * @file
 * Contains sector_portfolio.module.
 */

use Drupal\Core\Routing\RouteMatchInterface;
use \Drupal\block\Entity\Block;

/**
 * Implements hook_help().
 */
function sector_portfolio_help($route_name, RouteMatchInterface $route_match) {
  switch ($route_name) {
    // Main module help for the sector_portfolio module.
    case 'help.page.sector_portfolio':
      $output = '';
      $output .= '<h3>' . t('About') . '</h3>';
      $output .= '<p>' . t('Sector portfolio add on') . '</p>';
      return $output;

    default:
  }
}

/*function sector_portfolio_modules_installed($modules) {
  //print_r($modules);die();
  // We only want to run this on install of this module.
  if (in_array('sector_portfolio', $modules)) {
    // Load the menu block we want to add the condition to.
    $block = Block::load('mainmenu_3');
    if ($block) {
      $blockConditions = $block->getVisibilityConditions();
      if (!$blockConditions->has('request_path')) {
        // Create the block condition for the /portfolios path and save.
        $requestConditions =
          [
            'id' => 'request_path',
            'pages' => '/portfolios' . PHP_EOL,
            'negate' => FALSE,
            'context_mapping' => [],
          ];
        $block->setVisibilityConfig('request_path', $requestConditions);
        $block->save();
        return;
      }
      // Load the existing conditions.
      $blockRequestConditions = $block->getVisibilityCondition('request_path')->getConfiguration();
      // Check if the portfolio link is already there.
      $pos = strpos($blockRequestConditions['pages'], '/portfolios');
      if ($pos !== FALSE) {
        return;
      }
      // Add the portfolio link and save.
      $blockRequestConditions['pages'] .= PHP_EOL . '/portfolios';
      $block->setVisibilityConfig('request_path', $blockRequestConditions);
      $block->save();
    }
  }
}*/


