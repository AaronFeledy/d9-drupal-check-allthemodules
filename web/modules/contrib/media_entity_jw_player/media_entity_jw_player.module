<?php

/**
 * @file
 * Contains media_entity_jw_player.module.
 */

use Drupal\Core\Entity\EntityInterface;
/**
 * Implements hook_theme().
 */
function media_entity_jw_player_theme($existing, $type, $theme, $path) {
  return [
    'media_jw_embed' => [
      'variables' => [
        'width' => NULL,
        'height' => NULL,
        'allowfullscreen' => NULL,
        'allowautoplay' => NULL,
        'source' => NULL,
      ],
    ],
  ];
}

/**
 *
 */
function media_entity_jw_player_media_update(EntityInterface $entity) {

  $config = \Drupal::config('media_entity_jw_player.settings');
  $destination = $config->get('thumbnail_destination');
  $type = $entity->getEntityTypeId();
  $videoId = $entity->get('field_video')->value;
  $local_uri = $destination . '/' . $videoId . '.jpg';
  $image_url = 'https://content.jwplatform.com/thumbs/' . $videoId . '-720.jpg';
  $image = file_get_contents($image_url);
  $result = file_unmanaged_save_data($image, $local_uri, FILE_EXISTS_REPLACE);

}
