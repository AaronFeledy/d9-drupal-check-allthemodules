<?php

function digitallocker_example_theme($existing, $type, $theme, $path) {
  $templates = array();
  foreach (\Drupal\node\Entity\NodeType::loadMultiple() as $type => $desc) {
    // @FIXME
// // @FIXME
// // The correct configuration object could not be determined. You'll need to
// // rewrite this call manually.
// if (variable_get('digitallocker_enabled_' . $type)) {
//       $templates['node__' . $type] = array(
//         'render element' => 'content',
//         'base hook' => 'node',
//         'template' => 'node--' . $type,
//         'path' => drupal_get_path('module', 'digitallocker_example') . '/templates',
//       );
//     }

  }
  return $templates;
}

function digitallocker_example_node_view(array &$build, \Drupal\node\NodeInterface $node, $view_mode, $langcode) {
  foreach (\Drupal\node\Entity\NodeType::loadMultiple() as $type => $desc) {
    // @FIXME
// // @FIXME
// // The correct configuration object could not be determined. You'll need to
// // rewrite this call manually.
// if (variable_get('digitallocker_enabled_' . $type)) {
//       $list[] = $type;
//     }

  }

  if (in_array($node->getType(), $list) and 'full' == $view_mode) {
    // @FIXME
// The Assets API has totally changed. CSS, JavaScript, and libraries are now
// attached directly to render arrays using the #attached property.
// 
// 
// @see https://www.drupal.org/node/2169605
// @see https://www.drupal.org/node/2408597
// drupal_add_css(drupal_get_path('module', 'digitallocker_example') . '/templates/sheets-of-paper-a4.css', array(
//       'type' => 'file',
//       'weight' => 1000
//     ));

  }
}

/**
 * Implements hook_strongarm_alter().
 */
function digitallocker_example_strongarm_alter(&$variables) {
  if (array_key_exists('tokenize_drupal_variables_options', $variables)) {
    foreach (\Drupal\node\Entity\NodeType::loadMultiple() as $type => $desc) {
      // @FIXME
// // @FIXME
// // The correct configuration object could not be determined. You'll need to
// // rewrite this call manually.
// if (variable_get('digitallocker_enabled_' . $type)) {
//         $variables['tokenize_drupal_variables_options']->value['digitallocker_doctype_' . $type] = 'digitallocker_doctype_' . $type;
//       }

    }
  }
}

/**
 * Implements hook_node_info().
 */
function digitallocker_example_node_info() {
  return array(
    'dlex' => array(
      'name' => t('Digital Locker Example'),
      'base' => 'dlex',
      'description' => t('Used to demonstrate creation of digital certificates.'),
      'help' => 'This is a sample CT to demo Digital Locker Certificates.',
      'has_title' => TRUE,
      'title_label' => 'Title',
      'locked' => FALSE,
    )
  );
}
