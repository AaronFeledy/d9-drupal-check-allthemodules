<?php

use Drupal\Core\Form\FormStateInterface;

function _tmgmt_wordbee_pull_submit(array &$form, FormStateInterface $form_state) {
    /**
     * @var \Drupal\tmgmt\Entity\Job $job 
     */
    $job = $form_state->getFormObject()->getEntity();

    $controller = $job->getTranslator()->getPlugin();
    try {
        $nbFiles = $controller->updateCompletedJob($job);
        if($nbFiles > 0)
            drupal_set_message(t('The translation job have been refreshed : '.$nbFiles.' item(s) imported.', array('@number' => $nbFiles)));
        else
            drupal_set_message(t('The translation job have been refreshed : no item ready yet.'));
    } catch (Exception $e) {
        drupal_set_message('Error while retrieving the translations from Beebox:' . $e->getMessage());
    }
}