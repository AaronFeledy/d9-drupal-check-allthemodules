<?php

/**
 * @file
 * Contains quizard.module..
 */

use Drupal\Core\Routing\RouteMatchInterface;

/**
 * Implements hook_help().
 */
function quizard_help($route_name, RouteMatchInterface $route_match) {
  switch ($route_name) {
    // Main module help for the quizard module.
    case 'help.page.quizard':
      $output = '';
      $output .= <<<EOD
<h2>Quizard</h2>

The Quizard module provides Administrators an interface for creating quiz templates and users with a quiz wizard.

<h3>Installation</h3>
To install, place the quizard module in your modules directory. Navigate Manage > Extend, and enable Quizard.

<h3>Usage</h3>
<ol>
<li>Add a quiz by navigating Manage > Content > Add content > Quiz.</li>
<li>After saving a quiz you should arrive at /node/# where # is the node id. Navigate to /quiz/# to take the quiz.</li>
<li>Administrators can navigate Manage > Content > Quizard to see a list of quiz results.</li>
</ol>


<h3>Configure</h3>
You can configure Quizard by navigating Manage > Configuration > Workflow > Quizard Settings.
EOD;

      return $output;

    default:
  }
}

/**
 * Implements hook_theme().
 */
function quizard_theme($existing, $type, $theme, $path) {
  return array(
    'quizard_results' => array(
      'variables' => array('results' => NULL, 'grade' => NULL),
    ),
    'quizard_progress_bar' => array(
      'variables' => array(
        'wizard' => NULL,
        'cached_values' => array(),
        'operations' => NULL,
        'step' => NULL,
        'percent' => NULL,
        'time' => NULL,
      ),
    ),
  );
}

function template_preprocess_quizard_progress_bar(&$variables) {
  $operations = $variables['operations'];
  $step = $variables['step'];
  $variables['percent'] = round((((array_search($step, array_keys($operations))) / count($operations)) * 100));
}
