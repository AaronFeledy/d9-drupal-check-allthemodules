<?php

/**
 * @file
 * Code for the Admin Feedback module.
 */

use Drupal\views\ViewExecutable;

define('ADMIN_FEEDBACK_YES_VALUE', 1);
define('ADMIN_FEEDBACK_NO_VALUE', 0);

/**
 * Feedback theme function.
 */
function admin_feedback_theme($existing, $type, $theme, $path) {

  return array(
    'views_view_unformatted__feedback__nodes_list' => array(
      'render element' => 'elements',
      'template' => 'views/views-view-unformatted--feedback--nodes-list',
      'base hook' => 'views_view_unformatted',
    ),

    'views_view_unformatted__feedback__nodes_score' => array(
      'render element' => 'elements',
      'template' => 'views/views-view-unformatted--feedback--nodes-score',
      'base hook' => 'views_view_unformatted',
    ),

    'feedback_mail_template' => array (
      'render element' => 'elements',
      'template' => 'feedback_mail_template',
      'variables' => ['feedback_data' => NULL],
    ),
  );
}

/**
 * Implements hook_pre_render().
 */
function admin_feedback_views_pre_render(ViewExecutable $view)  {
  if ($view->id() == 'feedback') {
    $view->build_info['title'] = t('Admin Feedback');
  }
}


/**
 * Implements template_preprocess_views_view_unformatted().
 */
function admin_feedback_views_pre_view(ViewExecutable $view, $display_id, array &$args) {
  if ($view->id() == 'feedback') {
    $view->storage->addCacheTags(['feedback_cache_tags']);
  }
}

