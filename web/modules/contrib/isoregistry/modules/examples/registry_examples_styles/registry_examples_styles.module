<?php
use Drupal\node\Entity\Node;
use Drupal\file\Entity\File;

function registry_examples_styles_install() {
  
  $ids = \Drupal::entityQuery('taxonomy_term')
    ->condition('vid', 'namespaces') 
    ->condition('field_namespace', 'ex')  
    ->execute();
  $namespace = null;
  foreach ($ids as $key => $value) {
    $namespace = $value;
  }
  
  $exampleSVG01 = drupal_get_path('module', 'registry_examples_styles') . '/data/hell.svg';
  $uri  = file_unmanaged_copy($exampleSVG01,'public://', FILE_EXISTS_REPLACE);
  $fileSVG01 = File::Create([
    'uri' => $uri,
  ]);
  $fileSVG01->save();
  
  $exampleSVG02 = drupal_get_path('module', 'registry_examples_styles') . '/data/unicorn.svg';
  $uri  = file_unmanaged_copy($exampleSVG02,'public://', FILE_EXISTS_REPLACE);
  $fileSVG02 = File::Create([
    'uri' => $uri,
  ]);
  $fileSVG02->save();
  
  $exampleSLD = drupal_get_path('module', 'registry_examples_styles') . '/data/example.sld';
  $uri  = file_unmanaged_copy($exampleSLD,'public://', FILE_EXISTS_REPLACE);
  $fileSLD = File::Create([
    'uri' => $uri,
  ]);
  $fileSLD->save();
  
  $node = Node::create([
    'type' => 'styles',
    'title' => 'Beispielstyle',
    'body' => 'es handelt sich hierbei lediglich um ein Beispiel zur Veranschaulichung der Funktionsweise',
    'field_namespace' => $namespace,
  ]);
  $node->field_scalable_vector_graphics->setValue([['target_id' => $fileSVG01->id()],['target_id' => $fileSVG02->id()]]);
  $node->field_styled_layer_descriptor->setValue(['target_id' => $fileSLD->id()]);
  $node->save();
}
  

function registry_examples_styles_uninstall() {
   
}

