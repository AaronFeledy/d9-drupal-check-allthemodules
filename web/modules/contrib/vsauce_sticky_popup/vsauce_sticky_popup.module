<?php

/**
 * @file
 * Contains vsauce_sticky_popup..
 */

/**
 * {@inheritdoc}
 */
function vsauce_sticky_popup_preprocess_page(&$variables) {

  // Service sticky popup manager.
  $vsp = \Drupal::service('vsauce_sticky_popup.vsauce_sticky_popup_manager_controller');
  $markup = $vsp->renderItems();

  if ($markup) {
    $variables['page']['content'][] = [
      '#theme_wrappers' => ['region'],
      '#region' => 'content',
      '#cache' => [
        'max-age' => 0,
      ],
      'vsauce_sticky_popup_block' => [
        '#markup' => $markup,
        '#weight' => "-100",
      ],
    ];
  }
}

/**
 * Implements hook_theme().
 */
function vsauce_sticky_popup_theme($existing, $type, $theme, $path) {
  return [
    'vsauce_sticky_popup' => [
      'template' => 'vsauce-sticky-popup',
      'variables' => [
        'item' => '',
        'position' => '',
      ],
    ],
  ];
}
