services:

  # Key value store for mapping ids to uuids
  jsonapi_aliases.store:
    class: '\Drupal\jsonapi_aliases\KeyValueStore\Store'
    arguments: ['@keyvalue', '@cache.bootstrap', '@lock']

  # HTTP middleware for rewriting request uris & format of aliased JSON API resources
  jsonapi_aliases.http_middleware.path_and_format_setter:
    class: Drupal\jsonapi_aliases\StackMiddleware\PathAndFormatSetter
    arguments: ['@path.alias_manager', '@jsonapi_aliases.store', '@config.factory']
    tags:
      - { name: http_middleware, priority: 201 }
