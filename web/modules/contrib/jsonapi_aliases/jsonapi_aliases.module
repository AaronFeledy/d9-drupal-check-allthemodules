<?php

use Drupal\Core\Entity\EntityInterface;

/**
 * Implements hook_ENTITY_TYPE_insert().
 */
function jsonapi_aliases_entity_insert(EntityInterface $entity) {

  if (in_array($entity->getEntityTypeId(), \Drupal::service('config.factory')->get('jsonapi_aliases.settings')->get('entity_types'), true)) {
    \Drupal::service('jsonapi_aliases.store')->set('/' . $entity->toUrl('canonical')->getInternalPath(), [
      'type' => $entity->getEntityTypeId(),
      'bundle' => $entity->bundle(),
      'uuid' => $entity->uuid()
    ]);
  }

}

/**
 * Implements hook_ENTITY_TYPE_delete().
 */
function jsonapi_aliases_entity_delete(EntityInterface $entity) {
  if (in_array($entity->getEntityTypeId(), \Drupal::service('config.factory')->get('jsonapi_aliases.settings')->get('entity_types'), true)) {
    \Drupal::service('jsonapi_aliases.store')
      ->delete($entity->toUrl('canonical')->getInternalPath());
  }
}
