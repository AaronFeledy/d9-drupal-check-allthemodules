<?php
/**
 * @file
 * Main page_message functions.
 *
 */

use Drupal\Component\Utility\SafeMarkup;
use Drupal\Core\Routing\RouteMatchInterface;

/**
 *
 * This module allows administrators to create messages that will be displayed on a particular page.
 *
 * Key components:
 *    Form to add/edit/delete page/message pairs
 *    Display to list defined page/message pairs
 *    Hook to display page-specific message.
 *    Table to store page/message pairs. See page_message.install for details.
 *
 */

/**
 * Implements hook_help().
 *
 */
function page_message_help($route_name, RouteMatchInterface $route_match) {
  switch ($route_name) {
    case 'help.page.page_message':
    case '/admin/config/user-interface/page_message/messages':
    case '/admin/config/user-interface/page_message/settings':
    case '/admin/config/user-interface/page_message/add_update':
      $path = dirname(__FILE__) . '/README.txt';
      if (file_exists($path)) {
        $readme = file_get_contents($path);

      }
      if (!isset($readme)) {
        return NULL;
      }
      $output = '<pre>' . SafeMarkup::checkPlain($readme) . '</pre>';
      return $output;
  }
}



/**
 * Implements hook_attachments_alter().
 *
 */
function page_message_page_attachments_alter(array &$page) {

  $page['#attached']['library'][] = 'page_message/page_message';
}

