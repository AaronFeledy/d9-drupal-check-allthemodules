# modules/custom/merci/modules/merci_migration/migrations/merci_resource.yml
id: merci_resource
label: Merci Resource 
migration_group: Merci
migration_tags:
  - Custom

source:
  plugin: merci_resource

process:
  id: tnid
  langcode:
    plugin: default_value
    source: language
    default_value: en
  label: title
  title: title
  uid:
    -
      plugin: get
      source: node_uid
    -
      plugin: default_value
      default_value: 1
  created: created
  changed: changed
  'body':
    plugin: iterator
    source: body
    process:
      format:
        plugin: static_map
        bypass: true
        source: format
        map:
          1: basic_html
          2: full_html
      'value': value
      'summary': summary
  'field_merci_location/target_id':
    -
      plugin: default_value
      default_value: 'merci_hours_operation'
    -
      plugin: migration_lookup
      migration: merci_location
  'field_merci_grouping/target_id':
    plugin: migration_lookup
    migration: merci_permissions
    source: type
  field_reservable_status:
    plugin: static_map
    source: merci_default_availability
    map:
      1: 1
      2: 0
      3: 0
      4: 0

destination:
  plugin: 'entity:node'
  default_bundle: merci_resource
  migration_dependencies:
    required:
      - merci_location
      - merci_permissions
