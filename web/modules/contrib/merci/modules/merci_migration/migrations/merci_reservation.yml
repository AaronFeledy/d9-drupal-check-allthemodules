# modules/custom/merci/modules/merci_migration/migrations/merci_reservation.yml
id: merci_reservation
label: Merci Reservation
migration_group: Merci
migration_tags:
  - Custom

source:
  plugin: merci_reservation
  node_type: merci_reservation

process:
  id: tnid
  langcode:
    plugin: default_value
    source: language
    default_value: en
  label: title
  title: title
  uid:
    -
      plugin: get
      source: node_uid
    -
      plugin: default_value
      default_value: 1
  created: created
  changed: changed
  'body':
    plugin: iterator
    source: body
    process: 
      format:
        plugin: static_map
        bypass: true
        source: format
        map:
          1: basic_html
          2: full_html
      'value': value
      'summary': summary
  'field_merci_item':
    plugin: iterator
    source: merci_reservation_items
    process:
      target_id:
        plugin: migration_lookup
        migration: merci_line_item
        source: did


destination:
  plugin: 'entity:node'
  default_bundle: reservation
  migration_dependencies:
    required:
      - merci_line_item
