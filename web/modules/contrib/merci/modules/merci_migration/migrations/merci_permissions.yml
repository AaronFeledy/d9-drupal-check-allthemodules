# modules/custom/merci/modules/merci_migration/migrations/merci_permissions.yml
id: merci_permissions
label: Merci Permissions
migration_group: Merci
migration_tags:
  - Custom

source:
  plugin: merci_permissions

process:
  langcode:
    plugin: default_value
    source: language
    default_value: en
  name: name
  title: name
  uid:
    plugin: default_value
    default_value: 1
  created: created
  changed: changed

  field_max_length_of_reservation/interval: merci_max_hours_per_reservation
  field_max_length_of_reservation/period:
    plugin: default_value
    default_value: 'hour'

  field_merci_min_cancel_hours/interval: merci_min_cancel_hours
  field_merci_min_cancel_hours/period:
    plugin: default_value
    default_value: 'hour'

  field_merci_allow_overnight: merci_allow_overnight

  field_merci_allow_weekends: merci_allow_weekends

  field_merci_selfcheckout: merci_selfcheckout
  field_merci_autocheckin: merci_autocheckin
  field_merci_autocheckout: merci_autocheckout


  field_required_roles:
    plugin: iterator
    source: permissions
    process:
      target_id:
        plugin: migration_lookup
        migration: upgrade_d7_user_role
        source: rid


destination:
  plugin: 'entity:taxonomy_term'
  default_bundle: resource_tree
  migration_dependencies:
    required:
      - upgrade_d7_user_role
