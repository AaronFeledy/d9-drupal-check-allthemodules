<?php

/**
 * @file
 * Install and uninstall functions of the Invoice Agent module.
 */

use Drupal\Core\Database\Database;

/**
 * Implements hook_install().
 *
 * Adds the invoice_status field to commerce_order table.
 *
 * Possible values are:
 * - NULL - We haven't dealt with it yet.
 * - P - Order is completed, but we wait for the payment.
 * - C - The order and the payment are both completed.
 * - E - There was an error during invoice creation.
 */
function invoice_agent_install() {
  Database::getConnection()
    ->schema()
    ->addField('commerce_order', 'invoice_status', [
      'type' => 'varchar',
      'description' => 'Invoice status',
      'length' => 1,
      'not null' => FALSE,
    ]);
}

/**
 * Implements hook_uninstall().
 *
 * Remove the invoice_status fields from commerce_order table.
 */
function invoice_agent_uninstall() {
  Database::getConnection()
    ->schema()
    ->dropField('commerce_order', 'invoice_status');
}
